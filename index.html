<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>æ–å‰‘ä¼ è¯´ Â· æœ€ç»ˆæ¯”ä»·è®¡ç®—å™¨</title>

<style>
:root{
  --bg:#0b1220;
  --panel:#131c33;
  --card:#1a2545;
  --gold:#e8c77a;
  --cyan:#6fd3ff;
  --text:#e5edff;
  --muted:#9aa8cc;
  --green:#07c160;
}

*{box-sizing:border-box}
body{
  margin:0;
  background:radial-gradient(1200px 600px at 50% -200px,#22315a,#0b1220);
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC",sans-serif;
  color:var(--text);
}

.container{
  max-width:430px;
  margin:auto;
  padding:18px 14px 40px;
}

.panel{
  background:linear-gradient(180deg,#1a2545,#121b33);
  border-radius:18px;
  padding:18px;
  box-shadow:0 25px 60px rgba(0,0,0,.45);
}

.title{
  text-align:center;
  font-size:20px;
  color:var(--gold);
  margin-bottom:20px;
  font-weight: bold;
}

.field{margin-bottom:12px}
.label{
  font-size:13px;
  color:var(--muted);
  margin-bottom:6px;
}

input{
  width:100%;
  padding:12px 14px;
  border-radius:12px;
  border:1px solid #2b3a55;
  background:#0f172b;
  color:#fff;
  font-size:16px;
  outline: none;
  transition: border 0.3s;
}
input:focus{
  border-color: var(--cyan);
}

button{
  width:100%;
  margin-top:12px;
  padding:12px;
  border-radius:14px;
  border:none;
  font-size:16px;
  font-weight:600;
  background:linear-gradient(135deg,#e8c77a,#cfa24a);
  color:#2a1f00;
  cursor: pointer;
}
button:active{ opacity: 0.9; }

.btn-add {
    background: transparent;
    border: 1px dashed var(--muted);
    color: var(--muted);
}

.results{ margin-top:20px; border-top: 1px solid #2b3a55; padding-top: 20px;}

.card{
  background:#0f172b;
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
  position: relative;
}

.card h3{
  margin:0 0 10px;
  font-size:15px;
  color:var(--cyan);
  display: flex;
  justify-content: space-between;
}

/* å† å†›æ ·å¼ */
.best{
  border:1px solid var(--gold);
  background: rgba(232, 199, 122, 0.1);
}
.best::after {
    content: "æœ€çœé’±";
    position: absolute;
    top: -10px;
    right: 10px;
    background: var(--gold);
    color: #000;
    font-size: 12px;
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: bold;
}

.result-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.cost-display {
    text-align: right;
}
.cost-val {
    color: var(--gold);
    font-size: 18px;
    font-weight: bold;
}
.diff-val {
    font-size: 12px;
    color: #ff6b6b;
}

.footer{
  text-align:center;
  font-size:12px;
  color:#6f7fa6;
  margin-top:14px;
}
</style>
</head>

<body>
<div class="container">
  <div class="panel">
    <div class="title">ğŸ’ çŸ³å¤´ç»¼åˆæ¯”ä»·å™¨</div>

    <div class="field">
      <div class="label" style="color:#fff;">ğŸ¯ ç›®æ ‡çŸ³å¤´æ•°é‡</div>
      <input id="target" type="number" inputmode="numeric" value="1000" placeholder="ä¾‹å¦‚ï¼š1000">
    </div>

    <div class="card" style="border: 1px solid #3d4c70;">
        <h3>ğŸ›’ æ–¹æ¡ˆAï¼šç›´æ¥ä¹°æˆå“</h3>
        <div class="field">
            <div class="label">çŸ³å¤´å¸‚åœºä»·ï¼ˆ10ä¸ªï¼‰</div>
            <input id="stonePrice" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ï¼š52">
        </div>
    </div>

    <div id="fragPlans"></div>

    <button class="btn-add" onclick="addPlan()">+ æ·»åŠ å¦ä¸€ç§ç¢ç‰‡æ–¹æ¡ˆ</button>
    <button onclick="calc()">ğŸš€ å¼€å§‹è®¡ç®—</button>

    <div class="results" id="results"></div>
    <div class="footer">æ–å‰‘ä¼ è¯´ Â· æœ€ç»ˆç‰ˆ</div>
  </div>
</div>

<script>
let planCount = 0;
// é»˜è®¤åˆå§‹åŒ–ç»™ä¸€ä¸ªç¢ç‰‡æ–¹æ¡ˆï¼Œæ–¹ä¾¿ç›´æ¥å¡«
window.onload = function() {
    addPlan(); 
}

function addPlan(){
  planCount++;
  const id = planCount;

  const html = `
    <div class="card" id="plan-${id}">
      <h3>ğŸ§© ç¢ç‰‡æ–¹æ¡ˆ ${id} 
          <span onclick="removePlan(${id})" style="color:#666;font-size:12px;font-weight:normal;cursor:pointer;">âœ• åˆ é™¤</span>
      </h3>
      <div class="field">
        <div class="label">ç¢ç‰‡ä»·æ ¼ï¼ˆ10ä¸ªï¼‰</div>
        <input id="fragPrice-${id}" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ï¼š247">
      </div>
      <div class="field">
        <div class="label">æ¯ä¸ªç¢ç‰‡åˆ†è§£æˆå¤šå°‘çŸ³å¤´</div>
        <input id="fragToStone-${id}" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ï¼š2">
      </div>
    </div>
  `;
  document.getElementById('fragPlans').insertAdjacentHTML('beforeend', html);
}

function removePlan(id){
  const el = document.getElementById(`plan-${id}`);
  if(el) el.remove();
}

function calc(){
  const target = Number(document.getElementById("target").value);
  const resultsDiv = document.getElementById("results");

  if(!target){
    resultsDiv.innerHTML = `<div style="text-align:center;color:#ff6b6b">âš ï¸ è¯·è¾“å…¥ç›®æ ‡çŸ³å¤´æ•°é‡</div>`;
    return;
  }

  const plans = [];

  // 1. è·å–ç›´æ¥ä¹°çŸ³å¤´çš„ä»·æ ¼
  const stonePrice = Number(document.getElementById("stonePrice").value);
  if(stonePrice){
      const cost = (target / 10) * stonePrice;
      plans.push({
          name: "ç›´æ¥ä¹°æˆå“çŸ³å¤´",
          type: "stone",
          cost: cost,
          detail: `å•ä»· ${(stonePrice/10).toFixed(2)}`
      });
  }

  // 2. è·å–æ‰€æœ‰ç¢ç‰‡æ–¹æ¡ˆ
  const fragCards = document.querySelectorAll('[id^="plan-"]');
  fragCards.forEach((card, index) => {
      // ä»IDä¸­æå–æ•°å­—
      const idStr = card.id.split('-')[1]; 
      const fp = Number(document.getElementById(`fragPrice-${idStr}`).value);
      const fts = Number(document.getElementById(`fragToStone-${idStr}`).value);

      if(fp && fts){
          const cost = (target / (fts * 10)) * fp; // ä¿®æ­£ç®—æ³•ï¼š10ä¸ªç¢ç‰‡äº§å‡º 10*fts ä¸ªçŸ³å¤´
          plans.push({
              name: `ç¢ç‰‡æ–¹æ¡ˆ ${index + 1}`,
              type: "frag",
              cost: cost,
              detail: `å•ä»· ${(fp/(fts*10)).toFixed(2)}`
          });
      }
  });

  if(plans.length === 0){
    resultsDiv.innerHTML = `<div style="text-align:center;color:#ff6b6b">âš ï¸ è¯·è‡³å°‘è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„ä»·æ ¼æ–¹æ¡ˆ</div>`;
    return;
  }

  // 3. æ’åº
  plans.sort((a,b) => a.cost - b.cost);
  const bestCost = plans[0].cost;

  // 4. ç”Ÿæˆç»“æœHTML
  let html = "";
  plans.forEach((p, index) => {
    const isBest = index === 0;
    const diff = p.cost - bestCost;
    
    html += `
      <div class="card ${isBest ? 'best' : ''}">
        <div class="result-row">
            <div>
                <div style="color:${isBest ? 'var(--gold)' : '#fff'};font-weight:bold;">${p.name}</div>
                <div style="font-size:12px;color:#888;">${p.detail} å…ƒ/ä¸ª</div>
            </div>
            <div class="cost-display">
                <div class="cost-val">ï¿¥${Math.round(p.cost)}</div>
                ${!isBest ? `<div class="diff-val">å¤šèŠ± ${Math.round(diff)}</div>` : ''}
            </div>
        </div>
      </div>
    `;
  });

  resultsDiv.innerHTML = html;
  // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨çœ‹ç»“æœ
  resultsDiv.scrollIntoView({behavior: "smooth"});
}
</script>
</body>
</html>
